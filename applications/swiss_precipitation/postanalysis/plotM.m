function plotM(M, names, myGCA)

N = size(M,1);

if ~isempty(myGCA)
    fsize = myGCA.fsize;
end

% start plot
figure('Colormap',...
    [0 0 0.5625;0 0 0.625;0 0 0.6875;0 0 0.75;0 0 0.8125;0 0 0.875;0 0 0.9375;0 0 1;0 0.100000001490116 1;0 0.200000002980232 1;0 0.300000011920929 1;0 0.400000005960464 1;0 0.5 1;0 0.600000023841858 1;0 0.699999988079071 1;0 0.800000011920929 1;0 0.899999976158142 1;0 1 1;0.0909090936183929 1 0.909090936183929;0.181818187236786 1 0.818181812763214;0.272727280855179 1 0.727272748947144;0.363636374473572 1 0.636363625526428;0.454545468091965 1 0.545454561710358;0.545454561710358 1 0.454545468091965;0.636363625526428 1 0.363636374473572;0.727272748947144 1 0.272727280855179;0.818181812763214 1 0.181818187236786;0.909090936183929 1 0.0909090936183929;1 1 0;1 0.899999976158142 0;1 0.800000011920929 0;1 0.699999988079071 0;1 0.600000023841858 0;1 0.5 0;1 0.400000005960464 0;1 0.300000011920929 0;1 0.200000002980232 0;1 0.100000001490116 0;1 0 0;0.980000019073486 0 0;0.959999978542328 0 0;0.939999997615814 0 0;0.920000016689301 0 0;0.899999976158142 0 0;0.879999995231628 0 0;0.860000014305115 0 0;0.839999973773956 0 0;0.819999992847443 0 0;0.800000011920929 0 0;0.779999971389771 0 0;0.759999990463257 0 0;0.740000009536743 0 0;0.720000028610229 0 0;0.699999988079071 0 0;0.680000007152557 0 0;0.660000026226044 0 0;0.639999985694885 0 0;0.620000004768372 0 0;0.600000023841858 0 0;0.579999983310699 0 0;0.560000002384186 0 0;0.540000021457672 0 0;0.519999980926514 0 0;0.5 0 0]);

% Create a colored plot of the matrix values
imagesc(M);            

%Create strings from the matrix values & Remove any space padding
textStrings = num2str(M(:),'%0.2f');  
textStrings = strtrim(cellstr(textStrings));

% Create x and y coordinates for the strings
[x,y] = meshgrid(1:N);   
hStrings = text(x(:),y(:),textStrings(:), 'HorizontalAlignment','center','FontSize',fsize,'FontWeight','demi', 'Interpreter','LaTex');

% Get the middle value of the color range
midValue = mean(get(gca,'CLim'));  
index_l = M(:) > midValue;
index_s = M(:) < 0.25;
index = index_l + index_s;
index(index==2) = 1;
textColors = repmat(index,1,3);
set(hStrings,{'Color'},num2cell(textColors,2));  

set(gca,'XTick',1:N, 'XTickLabel',names,'YTick',1:N,'YTickLabel',names,...
    'TickLength',[0 0],'FontSize',fsize,'FontWeight','demi');

end
